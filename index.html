<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>안산교회 차량 신청</title>
    <style>
        body {
            font-family: sans-serif;
        }
        h1 {
            text-align: center;
            margin-bottom: 20px;
        }
        .calendar-container {
            margin-bottom: 20px;
            text-align: center;
        }
        /* 필요하다면 iframe 컨테이너 스타일 조정 */
        .calendar-container iframe {
            width: 800px; /* 원하는 너비로 조정 */
            height: 600px; /* 원하는 높이로 조정 */
            border: 1px solid #ccc; /* 선택 사항: 테두리 추가 */
        }
        .form-group {
            margin-bottom: 15px;
        }
        .form-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
        }
        .form-group input[type="text"],
        .form-group input[type="number"],
        .form-group input[type="time"],
        .form-group input[type="date"],
        .form-group select { /* select 요소에 대한 스타일 추가 */
            width: 100%;
            padding: 8px;
            border: 1px solid #ccc;
            border-radius: 4px;
            box-sizing: border-box;
        }
        #agreement-text {
            margin-top: 20px;
            margin-bottom: 10px;
            padding: 15px;
            border: 1px solid #ccc;
            border-radius: 4px;
            background-color: #f9f9f9;
            font-size: 0.9em;
            line-height: 1.5;
        }
    </style>
</head>
<body>
    <h1>안산교회 차량 신청</h1>

    <div class="calendar-container">
        <iframe src="https://calendar.google.com/calendar/embed?src=10263285edd19de93d9af3612d15a7c464b99f93d10f306e9a8576cbe181efe4%40group.calendar.google.com&ctz=Asia%2FSeoul" style="border: 0" width="800" height="600" frameborder="0" scrolling="no"></iframe>
    </div>

    <form id="reservation-form" onsubmit="submitForm(event)">
        <div class="form-group">
            <label for="applicant-name">신청자 성함:</label>
            <input type="text" id="applicant-name" name="applicant-name" required>
        </div>

        <div class="form-group">
            <label for="start-date">신청 날짜 (출발일):</label>
            <input type="date" id="start-date" name="start-date" required>
        </div>

        <div class="form-group">
            <label for="end-date">신청 날짜 (도착일):</label>
            <input type="date" id="end-date" name="end-date">
            <small>단일 날짜 신청 시 출발일과 동일하게 선택해주세요.</small>
        </div>

        <div class="form-group">
            <label for="departure-time">출발 시간:</label>
            <input type="time" id="departure-time" name="departure-time" required>
        </div>

        <div class="form-group">
            <label for="arrival-time">도착 시간:</label>
            <input type="time" id="arrival-time" name="arrival-time">
        </div>

        <div class="form-group">
            <label for="passenger-count">몇 명이 가시나요?</label>
            <input type="number" id="passenger-count" name="passenger-count" min="1" required>
        </div>

        <div class="form-group">
            <label for="destination">어디로 가시나요?</label>
            <input type="text" id="destination" name="destination" required>
        </div>

        <div class="form-group">
            <label for="vehicle-count">몇 대가 필요하신가요?</label>
            <select id="vehicle-count" name="vehicle-count" required>
                <option value="1">1대</option>
                <option value="2">2대</option>
                <option value="3">3대</option>
                <option value="버스1대">버스 1대</option>
                <option value="버스2대">버스 2대</option>
            </select>
        </div>

        <div class="form-group">
            <label for="purpose">용도가 어떻게 되시나요? 예) 시선부수련회</label>
            <input type="text" id="purpose" name="purpose" required>
        </div>

        <div id="agreement-text">
            <p>교회승합차 예약 및 배차에 대해 안내해 드리겠습니다.</p>
            <p>교회차량은 사용 용도에 따라 교회지원과 사용자 부담으로 구분합니다.</p>
            <ol>
                <li>교회지원
                    <ul>
                        <li>회/부서/교구/구역에서 봉사와 교회 공식일정을 위한 목적으로 차량 이용시</li>
                        <li>차량 유류비, 고속도로 톨게이트 비용 교회에서 지원</li>
                    </ul>
                </li>
                <li>사용자부담
                    <ul>
                        <li>회/부서/교구/구역에서 교회 비공식일정을 위한 목적으로 차량 이용시</li>
                        <li>차량 유류비, 고속도로 톨게이트 비용 사용자부담</li>
                    </ul>
                </li>
            </ol>
            <p>※ 교회 공식일정 : 년간/월간 계획 및 교회소식지에 광고된 교회의 각종 행사나 모임을 말함</p>
            <p>3) 차량 매뉴얼에 의해 교회 공식일정 및 우선순위에 따라 예약 및 배차가 변경될 경우 바로 연락드리도록 하겠습니다.</p>
            <p>해당사항 확인하신 후 아래 체크박스에 체크하고 제출 버튼을 눌러주시면 신청이 접수됩니다.</p>
        </div>

        <div class="form-group">
            <label for="agreement">동의:</label>
            <input type="checkbox" id="agreement" name="agreement" required>
            <small>위 내용을 확인하였으며, 이에 동의합니다.</small>
        </div>

        <button type="submit">신청하기</button>
    </form>

    <script>
        function submitForm(event) {
            event.preventDefault(); // 기본 폼 제출 동작을 막습니다.

            const form = document.getElementById('reservation-form');
            const formData = new FormData(form);

            // 동의 여부 확인
            if (!formData.get('agreement')) {
                alert('신청 전 안내사항에 동의해주세요.');
                return; // 폼 제출 중단
            }

            const data = {};
            formData.forEach((value, key) => {
                data[key] = value;
            });

            console.log("Form Data:", data); // 폼 데이터 로깅 추가 (디버깅)
            //data에 vehicle-count, purpose가 포함되어있는지 확인하기 위해 콘솔에 출력합니다.
            if(data['vehicle-count']){
                console.log("vehicle-count value is: " + data['vehicle-count'])
            }
            else{
                console.log("vehicle-count is not included in the form data")
            }

            if(data['purpose']){
                console.log("purpose value is: " + data['purpose'])
            }
            else{
                console.log("purpose is not included in the form data")
            }

            // 여기에 새로운 웹 앱 URL을 넣었습니다.
            const webAppUrl = 'https://script.google.com/macros/s/AKfycbzpyJY-sVvdfPw1rlM_-HhD0IPFKC9V8zh4JjGrj_dQa1WnLcmxjOvzLJAkKxU7ba7pyg/exec';

            fetch(webAppUrl, {
                method: 'POST',
                mode: 'no-cors', // CORS 오류 방지를 위해 추가 (응답 데이터를 읽을 수는 없음)
                headers: {
                    'Content-Type': 'application/x-www-form-urlencoded'
                },
                body: new URLSearchParams(formData).toString()
            })
            .then(response => {
                alert('신청이 완료되었습니다.');
                form.reset();
            })
            .catch(error => {
                console.error('Error:', error);
                alert('신청에 실패했습니다. 다시 시도해주세요.');
            });
        }
    </script>
</body>
</html>